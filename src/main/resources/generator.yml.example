# Bertie Configuration Example
# This file demonstrates ALL supported configuration options
# Copy this to generator.yml and customize for your project

# =============================================================================
# VARIABLES
# =============================================================================
# Define reusable variables with ${VAR_NAME} syntax
# Supports environment variable expansion with ${ENV_VAR}
variables:
  projects_folder: ${HOME}/projects
  my_project: my-java-app

# =============================================================================
# PROJECT PATHS
# =============================================================================

# Required: Absolute path to the project root containing src/main/java
# Can use variables defined above or environment variables
base_path: ${projects_folder}/${my_project}

# Optional: Custom output directory for generated files and reports
# Default: current directory
# output_path: ${projects_folder}/${my_project}/reports

# =============================================================================
# DUPLICATION DETECTOR CONFIGURATION
# =============================================================================
duplication_detector:
  
  # --------------------------------------------------------------------------
  # Target Selection
  # --------------------------------------------------------------------------
  
  # Optional: Fully qualified class name to analyze
  # If specified, only this class will be analyzed (focused analysis)
  # If omitted, all classes in the project will be analyzed
  target_class: "com.example.service.UserService"
  
  # --------------------------------------------------------------------------
  # Detection Thresholds
  # --------------------------------------------------------------------------
  
  # Minimum number of consecutive lines/statements to consider as duplicate
  # Range: 3-20 (typically 3-7)
  # Lower = more duplicates found (may include trivial duplicates)
  # Higher = only substantial duplicates
  # Default: 5
  min_lines: 5
  
  # Similarity threshold (0.0 to 1.0)
  # 0.75 = 75% similar code is considered duplicate
  # Range: 0.60-0.95
  # Lower = more lenient (finds more duplicates, may have false positives)
  # Higher = more strict (only very similar code)
  # Default: 0.75
  threshold: 0.75
  
  # --------------------------------------------------------------------------
  # Performance Tuning
  # --------------------------------------------------------------------------
  
  # Maximum window size growth beyond min_lines
  # Controls how much larger than min_lines a sequence can be
  # Example: min_lines=5, max_window_growth=5 â†’ windows from 5 to 10 lines
  # Range: 0-20 (typically 3-10)
  # Lower = faster, less coverage
  # Higher = slower, more coverage
  # Default: 5
  max_window_growth: 5
  
  # Extract only maximal (longest) sequences at each position
  # true = ignore smaller duplicates when larger ones exist (MUCH faster)
  # false = extract all window sizes (detects partial duplicates, slower)
  # Use true for large test classes, false for thorough analysis
  # Default: true
  maximal_only: true
  
  # --------------------------------------------------------------------------
  # Scope Control
  # --------------------------------------------------------------------------
  
  # Include test classes in analysis
  # true = analyze both src/main and src/test
  # false = only analyze src/main
  # Default: false
  include_tests: false
  
  # File patterns to exclude from analysis (glob format)
  # Useful for generated code, vendor libraries, etc.
  # Default: excludes common build directories
  exclude_patterns:
    - "**/target/**"
    - "**/build/**"
    - "**/generated/**"
    - "**/gen/**"
    - "**/.git/**"
    - "**/node_modules/**"
  
  # --------------------------------------------------------------------------
  # Presets (Alternative to individual settings)
  # --------------------------------------------------------------------------
  # Instead of configuring individual settings, use a preset
  # Uncomment ONE of these to use preset configuration
  # Presets override individual settings above
  
  # preset: "strict"      # 90% threshold, 7 min lines, maximalOnly=true
  # preset: "moderate"    # 75% threshold, 5 min lines, maximalOnly=true (default)
  # preset: "lenient"     # 60% threshold, 3 min lines, maximalOnly=false
  # preset: "aggressive"  # 60% threshold, 3 min lines, maximalOnly=false, includes tests
  # preset: "test_setup"  # 70% threshold, 3 min lines, lenient weights
  
  # --------------------------------------------------------------------------
  # Advanced: Similarity Algorithm Weights
  # --------------------------------------------------------------------------
  # Fine-tune how similarity is calculated
  # Three algorithms are combined using weighted average
  # Weights must sum to 1.0
  # Only modify if you understand the algorithms
  similarity_weights:
    # Longest Common Subsequence - token-level matching
    # Good for: identical code with different variable names
    lcs_weight: 0.4
    
    # Levenshtein distance - edit distance between sequences
    # Good for: code with small variations
    levenshtein_weight: 0.3
    
    # Structural similarity - AST pattern matching
    # Good for: similar control flow structures
    structural_weight: 0.3

# =============================================================================
# AI SERVICE CONFIGURATION (Optional)
# =============================================================================
# Required for AI-powered method naming suggestions
# If omitted, generic method names will be used
ai_service:
  
  # AI provider (currently only "gemini" supported)
  provider: "gemini"
  
  # Model name
  # Options: "gemini-2.0-flash-exp", "gemini-1.5-pro", etc.
  model: "gemini-2.0-flash-exp"
  
  # API endpoint (usually don't need to change)
  api_endpoint: "https://generativelanguage.googleapis.com/v1beta/models/{model}:generateContent"
  
  # API key - STRONGLY RECOMMENDED to use environment variable
  # DO NOT commit actual API keys to version control
  # Set environment variable: export GEMINI_API_KEY="your-key-here"
  api_key: "${GEMINI_API_KEY}"
  
  # Request timeout in seconds
  # Default: 30
  timeout_seconds: 30
  
  # Maximum retry attempts on failure
  # Default: 2
  max_retries: 2
  
  # Track API usage for cost estimation
  # Default: true
  track_usage: true
  
  # Cost per 1000 tokens (for usage tracking)
  # Update based on your pricing tier
  # Default: 0.00015 (Gemini Flash pricing)
  cost_per_1k_tokens: 0.00015

# =============================================================================
# EXAMPLE CONFIGURATIONS BY USE CASE
# =============================================================================

# Use Case 1: Quick scan of large codebase
# ------------------------------------------
# base_path: /path/to/large-project
# duplication_detector:
#   min_lines: 7
#   threshold: 0.85
#   maximal_only: true
#   max_window_growth: 3
#   include_tests: false

# Use Case 2: Thorough test class refactoring
# --------------------------------------------
# base_path: /path/to/project
# duplication_detector:
#   target_class: "com.example.MyTestClass"
#   min_lines: 3
#   threshold: 0.70
#   maximal_only: false  # Detect partial duplicates
#   max_window_growth: 7
#   include_tests: true

# Use Case 3: CI/CD quality gate
# -------------------------------
# base_path: ${CI_PROJECT_DIR}
# duplication_detector:
#   preset: "strict"
#   include_tests: false
#   exclude_patterns:
#     - "**/generated/**"
#     - "**/test/**"

# Use Case 4: Exploratory analysis
# ---------------------------------
# base_path: /path/to/project
# duplication_detector:
#   preset: "aggressive"
#   include_tests: true
# ai_service:
#   provider: "gemini"
#   api_key: "${GEMINI_API_KEY}"
